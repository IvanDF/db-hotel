ESERCIZIO DB-HOTEL QUERIES

- Selezionare tutte le stanze del primo piano

  SELECT *
  FROM `stanze`
  WHERE `floor` = '1';


- Seleziona tutte le prenotazioni precedenti a maggio 2018

  SELECT *
  FROM `prenotazioni`
  WHERE `created_at` < '2018-05-01'
  ORDER BY `created_at` DESC;


- Seleziona tutti gli ospiti che hanno più di 20 anni (al momento dell’esecuzione della query)

  SELECT `name`, `lastname`, `date_of_birth`
  FROM `ospiti`
  WHERE `date_of_birth` < NOW() - INTERVAL 20 YEAR
  ORDER BY `date_of_birth` DESC;


- Seleziona tutti gli ospiti il cui nome inizia con la E

  SELECT `name`, `lastname`
  FROM `ospiti`
  WHERE `name` LIKE 'e%';


- Calcola il totale degli ordini accepted

  SELECT SUM(`price`) AS `tot_price_accepted`
  FROM `pagamenti`
  WHERE `status` = 'accepted';


- Qual è il prezzo massimo pagato?

  SELECT MAX(`price`) AS `max_price`
  FROM `pagamenti`



- Seleziona gli ospiti riconosciuti con patente e nati nel 1975

  SELECT `name`, `lastname`, `date_of_birth`, `document_type`
  FROM `ospiti`
  WHERE `document_type` = 'Driver License'
  AND `date_of_birth` BETWEEN '1975-01-01' AND '1975-12-31';


- Quanti posti letto ha l’hotel in totale?

  SELECT SUM(`beds`) AS `tot_beds`
  FROM `stanze`

- Somma i prezzi dei pagamenti raggruppandoli per status

  SELECT SUM(`price`), `status` AS `tot_status_price`
  FROM `pagamenti`
  GROUP BY `status`
  ORDER BY `status` ASC